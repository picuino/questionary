<!DOCTYPE html>
<html lang="es-es">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

   <!--
   Copyright (c) 2022 Carlos Félix Pardo Martín

   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program. If not, see <https://www.gnu.org/licenses/>.

   -->

   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <meta name="description" content="Test online de Educación Secundaria de Software - Formatos de imagen II - Picuino">

   <title>Test Formatos de imagen II - Software - Picuino</title>

   <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png">
   <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96.png">
   <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48.png">

   <link rel="canonical" href="https://www.picuino.com/test/es-software-formatos-imagen-2.html">

   <style>
      body {
        background-color: #efefef;
        margin: 0;
        padding: 0;
        font-size: 12px;
        min-width: 320px;
        font-family: Arial, Helvetica, sans-serif;
        z-index: 0;
      }

      h1 {
        font-size: 32px;
        text-align: center;
        color: #094070;
        margin: 32px 0 12px 0;
      }

      h2 {
        font-size: 24px;
        margin-bottom: 24px;
        font-weight: 700;
      }

      .container {
        display: flex;
        justify-content: center;
        align-items: center;
        max-width: 764px;
        margin: 0 auto;
        padding: 0 8px 20px 8px;
      }

      .container > * {
        width: 100%;
      }

      .flex-column {
        display: flex;
        flex-direction: column;
      }

      .flex-center {
        justify-content: center;
        align-items: center;
      }

      .justify-center {
        justify-content: center;
      }

      .text-center {
        text-align: center;
      }

      .hidden {
        display: none;
      }

      ul, ol {
        padding: 0 0 0 40px;
        margin: 0;
      }


      /* BUTTONS */

      .btn {
        font-size: 18px;
        padding: 8px 0;
        width: 240px;
        text-align: center;
        border: 1px solid #094070;
        margin-bottom: 8px;
        text-decoration: none;
        color: #094070;
        background-color: white;
      }

      .btn:hover {
        cursor: pointer;
        box-shadow: 0 4px 14px 0 rgba(86, 185, 235, 0.5);
        transform: translateY(-1px);
        transition: transform 150ms;
      }

      .btn[disabled]:hover {
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
      }


      /* FOOTER */

      .footer {
        color: White;
        background-color: #094070;
        margin-top: 64px;
        padding: 12px;
        border-top: 2px solid #094070;
        line-height: 200%;
        text-align: center;
      }

      .footer p {
         margin: 4px 0;
      }

      .footer a, .footer a:visited {
        text-decoration: none;
        font-size: 12px;
        display: inline-block;
        color: White;
        padding: 0 2px 2px;
        margin-right: 12px;
      }

      .footer a:hover {
        color: #094070;
        background-color: #ecf5ff;
      }

      .choice-container {
        display: flex;
        margin-bottom: 6px;
        width: 100%;
        font-size: 18px;
        background-color: white;
      }

      @media only screen and (min-width: 600px) {
        .choice-container:hover {
          cursor: pointer;
          box-shadow: 0 0.4rem 1.4rem 0 rgba(86, 185, 235, 0.5);
          transform: translateY(1px);
          transition: transform 150ms;
        }
      }

      .choice-prefix {
        padding: 10px 18px;
        background-color: #094070;
        color: white;
        user-select: none;
      }

      .choice-text {
        padding: 10px;
        width: 100%;
        user-select: none;
      }

      .correct {
        background-color: #00ff60;
      }

      .incorrect {
        background-color: #ff2000;
        text-decoration: line-through;
      }

      #questionImage {
        margin-bottom: 24px;
        height: auto;
        max-width:100%;
      }

      .header {
         margin-top: 0;
         font-size: 32px;
      }

      /* HUD */

      .hud {
        display: flex;
        justify-content: space-between;
        margin: 0 0 12px 0;
      }

      .hud-prefix {
        text-align: center;
        font-size: 24px;
        margin: 12px 0;
      }

      .hud-main-text {
        text-align: center;
        font-size: 40px;
        font-weight: bold;
        color: #094070;
        margin: 12px 0;
      }

      #progress_bar_id {
        width: 200px;
        height: 40px;
        border: 3px solid #094070;
        margin-top: 15px;
      }

      #progress_bar_full_id {
        height: 40px;
        background-color: #094070;
        width: 0%;
      }


      /* CLOZE QUESTIONS */
      .table {
         overflow-x: auto;
         display: block;
      }

      table, tr {
         border-collapse: collapse;
         border-spacing: 0;
         empty-cells: show;
         margin: 12px 0;
      }

      td, th {
         border: 2px solid #aaa;
         padding: 0 8px;
      }

      thead {
         background-color: #eef;
      }

      .question_frame {
         margin: 0 0 12px 0;
         padding: 8px 6px;
         background-color: white;
         border: 2px solid #094070;
         border-radius: 12px;
      }

      .question_image_div {
         text-align: center;
      }

      .question_image {
         margin-bottom: 12px;
         height: auto;
         max-width:100%;
      }

      br {
         margin: 0;
      }

      .question_text {
         font-size: 20px;
         line-height: 160%;
         padding-bottom: 12px;
         min-height: 80px;
      }

      .gap_span, .gap_box {
         font-weight: bold;
      }

      input {
         font-family: Arial, Helvetica, sans-serif;
         font-size: 20px;
         padding: 1px;
         width: 125px;
         border: 1px solid #094070;
         border-radius: 8px;
         box-shadow: 0 0.1rem 0.5rem 0 rgba(128, 128, 128, 0.5);
      }

      .buttons {
         text-align: center;
         margin-top: 24px;
         line-height: 50px;
      }

      button {
         font-family: Arial, Helvetica, sans-serif;
         font-size: 20px;
         padding: 4px 8px;
         margin-right: 12px;
         cursor: pointer;
         text-align: center;
         border: 1px solid #094070;
         border-radius: 8px;
         box-shadow: 0.2em 0.3em 0.2em #888;
      }

      button:last-child {
         margin-right: 0;
      }

      .button:hover {
         background-color: #3e8e41
      }

      .button:active {
         background-color: #3e8e41;
         box-shadow: 0 5px #666;
         transform: translateY(4px);
      }

      .message {
         display: none;
         z-index: 10;
         height: 0;
         max-width: 75%;
         min-width: 300px;
         padding: 0 6px;
         margin: 0 auto;
      }

      .message2 {
         background-color: #eef;
         padding: 12px;
         height: auto;
         box-shadow: 0 0 6px 12px rgba(255, 255, 255, 0.9);
         border-radius: 16px;
         position: relative;
         top: 32px;
         text-align: center;
         border: 2px solid #094070;
         border-radius: 1rem;
         margin: 0px auto;
      }

      #message_text_id {
         padding-bottom: 1rem;
         min-height: 6px;
      }
   </style>

</head>

<body>
   <div class="container"> <div class="justify-center flex-column">

      <!-- HUD -->
      <div id="hud_id" class="hud">
         <div>
            <p class="hud-prefix" id="hud_page_id">Page</p>
            <div id="progress_bar_id"><div id="progress_bar_full_id"></div></div>
         </div>
         <div>
            <p class="hud-prefix">Puntos</p>
            <p class="hud-main-text" id="score">0</p>
         </div>
      </div>

      <!-- Main content -->
      <h1 class="header" id="header_id">Título</h1>

      <div class="message" id="message_id"><div class="message2">
      <div class="question_text" id="message_text_id">Mensaje.</div>
      <button id="message_button_id" class="func_button" onclick="message_hide();"> OK </button>
      </div></div>

      <div class="question_frame" id="question_frame_id"></div>

      <div class="buttons" id="buttons_id"></div>


      <!-- Footer -->
      <div class="footer">
      <a href="https://www.picuino.com/es/contacto.html" target="_blank">Contacto</a>
      <a href="https://www.picuino.com/es/legal-aviso.html" target="_blank">Aviso legal</a>
      <a href="https://www.picuino.com/es/legal-cookies.html" target="_blank">Política de Cookies</a>
      <a href="https://github.com/picuino/questionary/blob/master/Licenses.md" target="_blank">Créditos</a>
      <a href="https://github.com/picuino/questionary/" target="_blank">GitHub</a>
      <a href="https://www.picuino.com/test/index.html">Índice</a>

      <p><a href="https://www.picuino.com/es/informatica-software-imagenes.html" target="_blank">Fuente de los cuestionarios.</a></p>
      <p>Copyright © 2024 por Carlos Félix Pardo Martín.</p>
      <p>Licencia: <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.es" target="_blank">Creative Commons Attribution-ShareAlike 4.0</a></p>
      </div>

    </div>
  </div>

   <script>
      const show_max = 0;
      const num_tries = 0;
      const questions_title = "Software. Formatos de imagen II.";
      const questions_encoded = [
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvcyBkZSBtYXBhIGRlIGJpdHM8L3N0cm9uZz4gPGJyPiBMb3Mgc2lndWllbnRlcyBmb3JtYXRvcyBkZSBpbcOhZ2VuZXMgZGUgezB9IGRlIGJpdHMgZXN0w6FuIGNvbXB1ZXN0b3MgcG9yIHsxfSBvIHB1bnRvcyBkZSBsYSBpbWFnZW4gcXVlIHNlIGFsbWFjZW5hbiB1bm8gYSB1bm8gZW4gZWwgYXJjaGl2byBoYXN0YSBjb21wbGV0YXIgbGEgaW1hZ2VuLg==",
            "Gaps": [
               ['bWFwYQ=='],
               ['cMOteGVsZXM='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIEpQRUcgKEpQRyk8L3N0cm9uZz4gPGJyPiBFbCBmb3JtYXRvIEpQRUcgKEpvaW50IFBob3RvZ3JhcGhpYyBFeHBlcnRzIEdyb3VwKSwgY3JlYWRvIGVuIHswfSwgZXMgdW4gZm9ybWF0byBkZSBhcmNoaXZvIGRlIGltYWdlbiBxdWUgc2UgdXRpbGl6YSBwYXJhIGFsbWFjZW5hciB7MX0gZW4gdW4gZm9ybWF0byBjb21wcmltaWRvLiBFc3RlIGZvcm1hdG8gZGUgYXJjaGl2byB0aWVuZSB7Mn0gKGVzIGxvc3N5KSwgbG8gcXVlIHNpZ25pZmljYSBxdWUgc2UgcGllcmRlIGNpZXJ0YSBjYW50aWRhZCBkZSBpbmZvcm1hY2nDs24gZGUgbGEgaW1hZ2VuIGFsIHszfSBwYXJhIHF1ZSBvY3VwZSBtZW5vcyBlc3BhY2lvLCBlc3BlY2lhbG1lbnRlIGVuIGxvcyBwZXF1ZcOxb3MgezR9LCBnZW5lcmFuZG8gdW4gcnVpZG8gbGxhbWFkbyAiezV9Ii4gUG9yIGVzYSByYXrDs24gZXN0ZSBmb3JtYXRvIG5vIGVzIHVuYSBidWVuYSBvcGNpw7NuIHBhcmEgZ3VhcmRhciBpbcOhZ2VuZXMgZGUgezZ9LCB0ZXh0bywgZ3LDoWZpY2FzLCBldGMuIDxicj4gRWwgZm9ybWF0byBkZSBhcmNoaXZvIEpQRUcgc2UgcHVlZGUgdXRpbGl6YXIgcGFyYSBhbG1hY2VuYXIgaW3DoWdlbmVzIGVuIHZhcmlvcyBmb3JtYXRvcyBkZSBjb2xvciwgaW5jbHV5ZW5kbyB7N30gZGUgOCBiaXRzIHBvciBjb2xvciwgezh9IHkgWUNiQ3IuIExhIHByb2Z1bmRpZGFkIGRlIGNvbG9yIGRlIGVzdGUgZm9ybWF0byAoezl9IGJpdHMgcG9yIGNhZGEgdG9ubyBSR0IpIGVzIHJlZHVjaWRhIHkgcG9yIGxvIHRhbnRvIG5vIGVzIHVuYSBidWVuYSBvcGNpw7NuIHBhcmEgezEwfSBmb3RvZ3JhZsOtYXMuIFBhcmEgZXNhIHRhcmVhIGVzIG11Y2hvIG1lam9yIHV0aWxpemFyIGxvcyBmb3JtYXRvcyB7MTF9IGRlIGNhZGEgY8OhbWFyYSBmb3RvZ3LDoWZpY2EgcXVlIGxsZWdhbiBhIHRlbmVyIDM2IMOzIDQyIGJpdHMgcG9yIHBpeGVsLiA8YnI+IEVsIGZvcm1hdG8gSlBFRyBubyBwZXJtaXRlIGRlZmluaXIgezEyfSBlbiBsYSBpbWFnZW4gcG9yIGxvIHF1ZSB0YW1wb2NvIGVzIHVuYSBidWVuYSBvcGNpw7NuIHBhcmEgaW5zZXJ0YXIgaW3DoWdlbmVzIHJlY29ydGFkYXMuIFBhcmEgZXNhIHRhcmVhIGVzIG1lam9yIHV0aWxpemFyIHVuIGZvcm1hdG8gcXVlIHBlcm1pdGEgdHJhbnNwYXJlbmNpYXMsIGNvbW8gZWwgezEzfS4=",
            "Gaps": [
               ['MTk5Mg=='],
               ['Zm90b2dyYWbDrWFz'],
               ['cMOpcmRpZGFz'],
               ['Y29tcHJpbWlybGE='],
               ['ZGV0YWxsZXM='],
               ['YXJ0ZWZhY3Rvcw=='],
               ['ZGlidWpvcw=='],
               ['UkdC'],
               ['Q01ZSw=='],
               ['OA=='],
               ['ZWRpdGFy'],
               ['UkFX'],
               ['dHJhbnNwYXJlbmNpYXM='],
               ['UE5H'],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIFBORzwvc3Ryb25nPiA8YnI+IEVsIGZvcm1hdG8gUE5HIChQb3J0YWJsZSBOZXR3b3JrIEdyYXBoaWNzKSBmdWUgY3JlYWRvIGVuIHswfSBjb21vIHVuIGZvcm1hdG8gZGUgaW1hZ2VuIGNvbiBjb21wcmVzacOzbiB5IHNpbiB7MX0sIGVzIGRlY2lyLCBxdWUgbm8gcGllcmRlIG5pbmfDum4gZGV0YWxsZSBkdXJhbnRlIGxhIGNvbXByZXNpw7NuIGRlIGxhIGltYWdlbi4gPGJyPiBFbCBmb3JtYXRvIFBORyBlcyBpZGVhbCBwYXJhIGFsbWFjZW5hciBpbcOhZ2VuZXMgZGUgezJ9IG8gdGV4dG8geWEgcXVlLCBhbCBubyB0ZW5lciBww6lyZGlkYXMsIHNlIGFsbWFjZW5hcsOhbiBzaW4gezN9IG8gImFydGVmYWN0b3MiLiA8YnI+IEVzdGUgZm9ybWF0byB0YW1iacOpbiBlcyBpZGVhbCBwYXJhIGltw6FnZW5lcyBxdWUgdXRpbGljZW4gezR9LCB5YSBxdWUgY2FkYSBww614ZWwgcHVlZGUgc2VyIGFsbWFjZW5hZG8ganVudG8gYSB1biBjw7NkaWdvIGRlIGNvbG9yIHRyYW5zcGFyZW50ZSBxdWUgZXZpdGEgcXVlIHNlIG5vdGVuIGxvcyB7NX0uIDxicj4gU2kgYmllbiBzZSBwdWVkZSB1dGlsaXphciBwYXJhIGd1YXJkYXIgezZ9LCBubyBlcyBhY29uc2VqYWJsZSBwb3JxdWUsIGFsIG5vIHRlbmVyIHDDqXJkaWRhcywgc3UgdGFtYcOxbyBlcyBtdWNobyB7N30gcXVlIGVsIGRlIGxhcyBpbcOhZ2VuZXMgezh9LiBTaSBsbyBxdWUgc2UgZGVzZWEgZXMgZ3VhcmRhciB1bmEgZm90b2dyYWbDrWEgc2luIHDDqXJkaWRhcyBwYXJhIHBvZGVyIGVkaXRhcmxhLCBlcyBwcmVmZXJpYmxlIHV0aWxpemFyIGVsIGZvcm1hdG8gezl9LiA8YnI+IEVsIGZvcm1hdG8gUE5HIHB1ZWRlIGd1YXJkYXIgbGFzIGltw6FnZW5lcyBjb24gZGl2ZXJzYXMgcHJvZnVuZGlkYWRlcyBkZSB7MTB9IGFkYXB0YWRhcyBhIGNhZGEgYXBsaWNhY2nDs24uIENvbiBsb3MgY29sb3JlcyBibGFuY28geSBuZWdybyAoMSBiaXQgcG9yIHBpeGVsKSBzZSBwdWVkZW4gYWxtYWNlbmFyIGltw6FnZW5lcyBkZSB0ZXh0byBvIHNpbWlsYXJlcyBjb24gdW4gbml2ZWwgZGUgezExfSBtdXkgYWx0by4gVGFtYmnDqW4gc2UgcHVlZGVuIGFsbWFjZW5hciBpbcOhZ2VuZXMgZW4gZXNjYWxhIGRlIHsxMn0gbyBpbcOhZ2VuZXMgY29uIGNvbG9yIHZlcmRhZGVybyAoezEzfSBkZSA4IGJpdHMgcG9yIGNvbG9yKS4gPGJyPiBFbCBmb3JtYXRvIFBORyBubyBwZXJtaXRlIGFsbWFjZW5hciBjb2xvcmVzIHsxNH0gYWRhcHRhZG9zIGEgbGEgaW1wcmVzacOzbiBlbiBwYXBlbC4=",
            "Gaps": [
               ['MTk5NQ=='],
               ['cMOpcmRpZGFz'],
               ['ZGlidWpvcw=='],
               ['cnVpZG8='],
               ['dHJhbnNwYXJlbmNpYXM='],
               ['Ym9yZGVz'],
               ['Zm90b2dyYWbDrWFz'],
               ['bWF5b3I='],
               ['SlBFRw=='],
               ['VElGRg=='],
               ['Y29sb3I='],
               ['Y29tcHJlc2nDs24='],
               ['Z3Jpc2Vz'],
               ['UkdC'],
               ['Q01ZSw=='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIEdJRjwvc3Ryb25nPiA8YnI+IEVsIGZvcm1hdG8gR0lGIChHcmFwaGljcyBGb3JtYXQgSW50ZXJjaGFuZ2UpIGZ1ZSBsYW56YWRvIGVuIHswfSBwb3IgQ29tcHVTZXJ2ZSB5IGVzIGFtcGxpYW1lbnRlIHV0aWxpemFkbyBlbiB7MX0gdGFudG8gZW4gaW3DoWdlbmVzIGNvbW8gZW4gYW5pbWFjaW9uZXMgZGViaWRvIGEgc3UgYW1wbGlvIHNvcG9ydGUgeSBjb21wYXRpYmlsaWRhZC4gPGJyPiBDb21vIGNhcmFjdGVyw61zdGljYSBlc3BlY2lhbCwgZXN0ZSBlcyBlbCDDum5pY28gZm9ybWF0byBwb3B1bGFyIHF1ZSBwdWVkZSBndWFyZGFyIGltw6FnZW5lcyBlbiBtb3ZpbWllbnRvIG8gezJ9LiBMb3MgdsOtZGVvcyBjb24gaW3DoWdlbmVzIGZvdG9ncsOhZmljYXMgYXBhcmVjZW4gY29uIHVuYSBncmFuIHDDqXJkaWRhIGRlIHszfSBkZWJpZG8gYSBxdWUgZXN0ZSBmb3JtYXRvIHNvbG8gcHVlZGUgbWFuZWphciB1bmEgcGFsZXRhIGRlIDI1NiBjb2xvcmVzLCBubyBvYnN0YW50ZSBlc3RvIG5vIGhhIGltcGVkaWRvIHF1ZSBzZWEgbXV5IHs0fS4gPGJyPiBFbCBmb3JtYXRvIEdJRiBwZXJtaXRlIGd1YXJkYXIgZGlidWpvcyBjb24gezV9LCBwZXJvIGNvbiBwZW9yIGNhbGlkYWQgcXVlIGNvbiBlbCBmb3JtYXRvIFBORyBkZSAyNCBiaXRzLiA8YnI+IExhIGFwbGljYWNpw7NuIHByaW5jaXBhbCBkZWwgZm9ybWF0byBHSUYgZXMgYWxtYWNlbmFyIHBlcXVlw7FvcyBkaWJ1am9zIHkgezZ9IGNvbiBvIHNpbiB7N30u",
            "Gaps": [
               ['MTk4Nw=='],
               ['SW50ZXJuZXQ='],
               ['YW5pbWFjaW9uZXM='],
               ['Y29sb3I='],
               ['dXRpbGl6YWRv'],
               ['dHJhbnNwYXJlbmNpYXM='],
               ['YW5pbWFjaW9uZXM='],
               ['dHJhbnNwYXJlbmNpYQ=='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIFRJRkY8L3N0cm9uZz4gPGJyPiBFbCBmb3JtYXRvIFRJRkYgKFRhZ2dlZCBJbWFnZSBGaWxlIEZvcm1hdCkgc2UgcHVibGljw7MgZW4gc3UgdmVyc2nDs24gNiBlbiB7MH0geSB0aWVuZSB1biBncmFuIHVzbyBlbiBsYSBpbmR1c3RyaWEgZ3LDoWZpY2EgeSBlbiBsYSBmb3RvZ3JhZsOtYSB7MX0gcG9yIHN1IHZlcnNhdGlsaWRhZCB5IGNvbXByZXNpw7NuIHNpbiB7Mn0uIDxicj4gRXMgdW4gZm9ybWF0byBxdWUgb2N1cGEgbXVjaGEgbWVtb3JpYSBjdWFuZG8gYWxtYWNlbmEgZm90b2dyYWbDrWFzIHNpbiBww6lyZGlkYXMsIGVzcGVjaWFsbWVudGUgc2kgc2UgdXRpbGl6YSB1bmEgZ3JhbiBwcm9mdW5kaWRhZCBkZSBjb2xvciwgY29uIHszfSBiaXRzIHBvciBjYWRhIHRvbm8gZGUgY29sb3IgUkdCLiBTaW4gZW1iYXJnbywgZXN0YXMgY2FyYWN0ZXLDrXN0aWNhcyBoYWNlbiBxdWUgZWwgZm9ybWF0byB7NH0gc2VhIG11eSBhcHJlY2lhZG8gZW4gZWRpY2nDs24gZm90b2dyw6FmaWNhIHByb2Zlc2lvbmFsIHkgZm90b2dyYWbDrWEgezV9Lg==",
            "Gaps": [
               ['MTk5Mg=='],
               ['cHJvZmVzaW9uYWw='],
               ['cMOpcmRpZGFz'],
               ['MTY='],
               ['VElGRg=='],
               ['Y2llbnTDrWZpY2E='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIFJBVzwvc3Ryb25nPiA8YnI+IEVsIGZvcm1hdG8gUkFXIGVzIHVuIGNvbmp1bnRvIGRlIGZvcm1hdG9zIHF1ZSB1dGlsaXphbiBsYXMgY8OhbWFyYXMgZm90b2dyw6FmaWNhcyB7MH0geSBkZSB7MX0gZ2FtYSBwYXJhIGd1YXJkYXIgbGFzIGltw6FnZW5lcyB0YWwgeSBjb21vIGhhbiBzaWRvIGNhcHRhZGFzIHBvciBlbCB7Mn0gZGUgbGEgY8OhbWFyYS4gVGllbmVuIHVuYSBncmFuIHByb2Z1bmRpZGFkIGRlIGNvbG9yIChkZSAzNiBhIHszfSBiaXRzIHBvciBwaXhlbCkgeSBzZSBhbG1hY2VuYW4gc2luIHDDqXJkaWRhcywgcG9yIGxvIHF1ZSBjYWRhIGZpY2hlcm8gb2N1cGEgdW4gZ3JhbiB0YW1hw7FvIGNvbXBhcmFkbyBjb24gbGEgaW1hZ2VuIGVxdWl2YWxlbnRlIGVuIGZvcm1hdG8gezR9LiA8YnI+IEVzdGUgZm9ybWF0byBwZXJtaXRlIHByb2Nlc2FyIG8gJ3s1fScgdW5hIGltYWdlbiBwYXJhIHF1ZSB0ZW5nYSBtw6FzIG8gbWVub3MgbHVtaW5vc2lkYWQgbyBtw6FzIG8gbWVub3MgcmFuZ28gZGluw6FtaWNvLCBzaW4gcXVlIHNlIHBpZXJkYSB7Nn0gZW4gZWwgcmVzdWx0YWRvIGZpbmFsLiA8YnI+IEVsIGluY29udmVuaWVudGUgcXVlIHByZXNlbnRhIGVzdGUgZm9ybWF0byBlcyBsYSBmYWx0YSBkZSB7N30sIHBvciBsbyBxdWUgY2FkYSBmYWJyaWNhbnRlIHV0aWxpemEgc3UgcHJvcGlhIHZlcnNpw7NuIGRlbCBmb3JtYXRvLCBsbyBxdWUgcHVlZGUgcHJvZHVjaXIgaW5jb21wYXRpYmlsaWRhZGVzIG8gcXVlIGFsZ3VuYSB2ZXJzacOzbiBkZWwgZm9ybWF0byBSQVcgbm8gc2UgcHVlZGEgdXNhciBlbiBlbCB7OH0u",
            "Gaps": [
               ['cHJvZmVzaW9uYWxlcw=='],
               ['YWx0YQ=='],
               ['c2Vuc29y'],
               ['NDg='],
               ['SlBFRw=='],
               ['cmV2ZWxhcg=='],
               ['Y2FsaWRhZA=='],
               ['ZXN0YW5kYXJpemFjacOzbg=='],
               ['ZnV0dXJv'],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvcyB2ZWN0b3JpYWxlczwvc3Ryb25nPiA8YnI+IExvcyBmb3JtYXRvcyBkZSBpbcOhZ2VuZXMgdmVjdG9yaWFsZXMgZXN0w6FuIGNvbXB1ZXN0b3MgcG9yIHZlY3RvcmVzLCBxdWUgc29uIHswfSBtYXRlbcOhdGljYXMgcXVlIHNlIGxlIGRhbiBhbCBuYXZlZ2Fkb3IgbyBhIHByb2dyYW1hcyBkZSB7MX0gZGUgZXN0b3MgZ3LDoWZpY29zIHBhcmEgcXVlIHNlIHB1ZWRhbiB2aXN1YWxpemFyLiBFc3RhcyBpbcOhZ2VuZXMgc2UgcHVlZGVuIHsyfSBkZSBtYW5lcmEgaW5maW5pdGEgc2luIHBlcmRlciByZXNvbHVjacOzbiBvIHszfS4=",
            "Gaps": [
               ['aW5zdHJ1Y2Npb25lcw=='],
               ['ZWRpY2nDs24='],
               ['ZXNjYWxhcg=='],
               ['Y2FsaWRhZA=='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIFNWRzwvc3Ryb25nPiA8YnI+IEVsIGZvcm1hdG8gU1ZHIChTY2FsYWJsZSBWZWN0b3IgezB9KSBlcyB1biBlc3TDoW5kYXIgYWJpZXJ0byBwdWJsaWNhZG8gcG9yIGVsIGNvbnNvcmNpbyB7MX0gZW4gMTk5OSBwYXJhIGRpc3RyaWJ1aXIgaW3DoWdlbmVzIGVuIGxhIHdlYi4gPGJyPiBFc3RlIGZvcm1hdG8gcGVybWl0ZSBkZWZpbmlyIGltw6FnZW5lcyB7Mn0gZW4gZG9zIGRpbWVuc2lvbmVzLiA8YnI+IExhcyBpbcOhZ2VuZXMgU1ZHIHB1ZWRlbiBtYW5pcHVsYXJzZSBjb24gezN9LCBxdWUgZXMgdW4gbGVuZ3VhamUgZGUgcHJvZ3JhbWFjacOzbiwgcGFyYSBjcmVhciB7NH0gaW50ZXJhY3RpdmFzIGVuIGxvcyBuYXZlZ2Fkb3JlcyB3ZWIu",
            "Gaps": [
               ['R3JhcGhpY3M='],
               ['VzND'],
               ['dmVjdG9yaWFsZXM='],
               ['SmF2YVNjcmlwdA=='],
               ['YW5pbWFjaW9uZXM='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "PHN0cm9uZz5Gb3JtYXRvIFBERjwvc3Ryb25nPiA8YnI+IEVsIGVzdMOhbmRhciBQREYgKFBvcnRhYmxlIHswfSBGb3JtYXQpIGVzIHVuIGZvcm1hdG8gZGUgYWxtYWNlbmFtaWVudG8gZGUgZG9jdW1lbnRvcyBkaWdpdGFsZXMgZGlzZcOxYWRvIHBvciB7MX0gcGFyYSBxdWUgc2UgcHVlZGEgdmlzdWFsaXphciBlIGltcHJpbWlyIGbDoWNpbG1lbnRlIGVuIGN1YWxxdWllciB7Mn0uIDxicj4gUERGIGVzIHVuIGZvcm1hdG8gZXN0YW5kYXJpemFkbyB5IHszfSBhIHF1ZSBjdWFscXVpZXJhIGxvIHV0aWxpY2UgbGlicmVtZW50ZS4gPGJyPiBMb3MgZG9jdW1lbnRvcyBndWFyZGFkb3MgZW4gZm9ybWF0byBQREYgcHVlZGVuIGNvbnRlbmVyIHRleHRvLCB7NH0sIGdyw6FmaWNhcywgZGlidWpvcywgZm90b2dyYWbDrWFzIHkgaGFzdGEgezV9LiA8YnI+IEVzdGUgZm9ybWF0byB0aWVuZSBsYSBncmFuIHZlbnRhamEgZGUgbWFudGVuZXIgaW5hbHRlcmFkYSBsYSB7Nn0gZGUgcMOhZ2luYSAobcOhcmdlbmVzLCB0YW1hw7FvcyBkZSBsZXRyYSwgcG9zaWNpw7NuIGRlIGxhcyBpbcOhZ2VuZXMsIGV0Yy4pIHkgZGUgc2VyIHVuIGZvcm1hdG8gYW1wbGlhbWVudGUgezd9IHkgZXN0w6FuZGFyIHBhcmEgYWxtYWNlbmFyIGRvY3VtZW50b3MgYSBsYXJnbyB7OH0uIDxicj4gQ29tbyBkZXN2ZW50YWphLCBlbCBmb3JtYXRvIFBERiBzZSBwdWVkZSBlZGl0YXIgY29uIHs5fSwgcG9yIGxvIHF1ZSBlcyBtZWpvciBhbG1hY2VuYXIgdGFtYmnDqW4gZWwgYXJjaGl2byBmdWVudGUgb3JpZ2luYWwgKC5kb2N4KS4=",
            "Gaps": [
               ['RG9jdW1lbnQ='],
               ['QWRvYmU='],
               ['ZGlzcG9zaXRpdm8='],
               ['YWJpZXJ0bw=='],
               ['aGlwZXJ2w61uY3Vsb3M='],
               ['dsOtZGVv'],
               ['Y29tcG9zaWNpw7Nu'],
               ['Y29tcGF0aWJsZQ=='],
               ['cGxhem8='],
               ['ZGlmaWN1bHRhZA=='],
            ]
         },
         
         {
            "Image": ["", ""],
            "Cloze": "IDxzdHJvbmc+Rm9ybWF0byBkZSBmdWVudGVzIHRpcG9ncsOhZmljYXM8L3N0cm9uZz4gPGJyPiBMYXMgZnVlbnRlcyB0aXBvZ3LDoWZpY2FzIHZlY3RvcmlhbGVzIHNvbiBjb25qdW50b3MgZGUgezB9IHkgbGV0cmFzIGRpc2XDsWFkb3MgcGFyYSBzdSB1c28gZW4gY29tcHV0YWRvcmFzLCB0YW50byBwYXJhIHsxfSB0ZXh0byBlbiB1bmEgcGFudGFsbGEgY29tbyBwYXJhIGltcHJpbWlyIGVuIHsyfS4gPGJyPiBBbCBzZXIgdmVjdG9yaWFsZXMgc29uIGbDoWNpbG1lbnRlIHszfSwgZXMgZGVjaXIgcXVlIGxhcyBsZXRyYXMgeSBzw61tYm9sb3Mgc2UgcHVlZGVuIHJlcHJlc2VudGFyIGVuIGN1YWxxdWllciB0YW1hw7FvIHNpbiBwZXJkZXIgezR9LiA8YnI+IExvcyBmb3JtYXRvcyBtw6FzIHV0aWxpemFkb3MgcGFyYSBkZWZpbmlyIGZ1ZW50ZXMgc29uIGxvcyBzaWd1aWVudGVzLiA8YnI+IDx1bD4gPGxpPlRydWVUeXBlIChUVEYpOiBGb3JtYXRvIGRlc2Fycm9sbGFkbyBwb3IgezV9IHkgTWljcm9zb2Z0IGEgZmluYWxlcyBkZSBsYSBkw6ljYWRhIGRlIHs2fS4gRXMgYW1wbGlhbWVudGUgY29tcGF0aWJsZSB5IG11eSB1dGlsaXphZG8gZW4gV2luZG93cyB5IG1hY09TLjwvbGk+IDxsaT5Qb3N0U2NyaXB0IChQUyk6IExlbmd1YWplIGRlc2Fycm9sbGFkbyBwb3Igezd9IHBhcmEgbGEgaW1wcmVzacOzbiBjb24gaW1wcmVzb3JhcyBkZSBhbHRhIGNhbGlkYWQuIDxicj4gUGVybWl0ZSBkZWZpbmlyIHRpcG9zIGRlIHs4fSwgYXVucXVlIHRpZW5lIG11Y2hhcyBtw6FzIGFwbGljYWNpb25lcy48L2xpPiA8bGk+T3BlblR5cGUgKE9URik6IEZvcm1hdG8gZGVzYXJyb2xsYWRvIHBvciB7OX0geSBBZG9iZSBlbiAxOTk2IHBhcmEgbWVqb3JhciB5IHN1Y2VkZXIgYSBsb3MgZG9zIGZvcm1hdG9zIHsxMH0uIDxicj4gQWN0dWFsbWVudGUgZXMgdW4gZXN0w6FuZGFyIHsxMX0gKE9wZW4gRm9udCBGb3JtYXQpLCBkaXNwb25pYmxlIGRlICBtYW5lcmEgcMO6YmxpY2EgeSBncmF0dWl0YS48L2xpPiA8bGk+VGVYOiBFcyB1biBzaXN0ZW1hIGRlIHRpcG9ncmFmw61hIGVzY3JpdG8gcG9yIERvbmFsZCBFLiBLbnV0aCwgbXV5IHBvcHVsYXIgZW4gZWwgZW50b3JubyBhY2Fkw6ltaWNvIHsxMn0uIEVsIHNpc3RlbWEgezEzfSBhc29jaWFkbywgYW1wbMOtYSBsYXMgY2FwYWNpZGFkZXMgZGUgVGVYIHBhcmEgY29tcG9zaWNpw7NuIGRlIHRleHRvcyBwcm9mZXNpb25hbC4gPGJyPiBFc3RlIHNpc3RlbWEgZXMgc29mdHdhcmUgezE0fSwgcG9yIGxvIHF1ZSBjdWFscXVpZXJhIHB1ZWRlIHV0aWxpemFybG8gc2luIHBhZ2FyIGxpY2VuY2lhLjwvbGk+IDwvdWw+IA==",
            "Gaps": [
               ['c8OtbWJvbG9z'],
               ['dmlzdWFsaXphcg=='],
               ['cGFwZWw='],
               ['ZXNjYWxhYmxlcw=='],
               ['Y2FsaWRhZA=='],
               ['QXBwbGU='],
               ['MTk4MA=='],
               ['QWRvYmU='],
               ['bGV0cmE='],
               ['TWljcm9zb2Z0'],
               ['YW50ZXJpb3Jlcw=='],
               ['YWJpZXJ0bw=='],
               ['dW5pdmVyc2l0YXJpbw=='],
               ['TGFUZVg='],
               ['bGlicmU='],
            ]
         },
         
      ]

      const time_between_clues = 1000;
      var questions_pages = 0;
      var gap_selected = 0;
      var page = 0;
      var gaps_total = 0;
      var gaps_values = [];
      var points_total = 0;
      var gaps_not_solved = 0;
      var watermark = 0;
      var interval;
      var timeout_clue = 0;
      var timeout_last_score = 0;
      var final_score_interval;

      if (!String.prototype.format) {
         String.prototype.format = function() {
            var args = arguments;
            return this.replace(/{(\d+)}/g, function(match, number) {
               return typeof args[number] != 'undefined'
                  ? args[number]
                  : match;
            });
         };
      }

      page_reset();

      function page_reset() {
         if (final_score_interval) {
            clearInterval(final_score_interval);
         }
         page = 0;
         points_total = 0;
         if (show_max > 0 && show_max < questions_encoded.length) {
            questions_sorted = questions_sort(show_max);
         }
         else {
            questions_sorted = questions_sort(questions_encoded.length);
         }
         question_numpages = questions_sorted.length;
         gaps_total = questions_gaps();
         gaps_values = get_gaps_values();
         gaps_tries = get_gaps_tries();
         gaps_not_solved = 0;
         fill_question_text(page);
         message_hide();
         hud_show();
      }

      function bin_atob(str) {
         return decodeURIComponent(atob(str).split('').map(function(c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
      }

      function questions_sort(len) {
         new_questions = JSON.parse(JSON.stringify(questions_encoded));
         questions_sorted = new Array(len);
         for(i=0; i<len; i++) {
            rnd = Math.floor(Math.random() * new_questions.length);
            questions_sorted[i] = new_questions[rnd];
            questions_sorted[i]["Cloze"] = bin_atob(questions_sorted[i]["Cloze"]);
            for(var j=0; j < questions_sorted[i]["Gaps"].length; j++) {
               for(var k=0; k < questions_sorted[i]["Gaps"][j].length; k++) {
                  questions_sorted[i]["Gaps"][j][k] = bin_atob(questions_sorted[i]["Gaps"][j][k]);
               };
            };
            new_questions.splice(rnd, 1);
         }
         return questions_sorted;
      }

      function get_gaps_values() {
         var gaps_values = [];
         for(var page=0; page<questions_sorted.length; page++) {
            gaps_values.push([]);
            for(var num_gap=0; num_gap<questions_sorted[page]["Gaps"].length; num_gap++) {
               gaps_values[page].push(string_to_binary_array(questions_sorted[page]["Gaps"][num_gap][0]));
            };
         };
         return gaps_values;
      }

      function get_gaps_tries() {
         var gaps_tries = [];
         for(var page=0; page<questions_sorted.length; page++) {
            gaps_tries.push([]);
            for(var num_gap=0; num_gap<questions_sorted[page]["Gaps"].length; num_gap++) {
               gaps_tries[page].push(num_tries);
            };
         };
         return gaps_tries;
      }

      function string_to_binary_array(str, chr) {
         array = [];
         if (str.length == 1) {
            array.push(100);
            return array;
         }

         // Valor de las sucesivas letras de una palabra
         for(var i=0; i<str.length; i++) {
            const func = "Lineal";
            if (func === "Exponencial") {
               // Exponencial
               array.push(100 * Math.pow(2, str.length-i-1) / (Math.pow(2, str.length) - 1));
            }
            else {
               // Lineal
               array.push(100 * (1.0 - i / (2*str.length-2)) / (0.75 * str.length));
            };
         };
         return array;
      }

      function add_terms(array) {
         sum = 0;
         for(var i=0; i<array.length; i++) {
            sum += array[i];
         }
         return sum;
      }

      function questions_gaps() {
         var gaps = 0;
         for(var page=0; page<questions_sorted.length; page++) {
            gaps += questions_sorted[page]["Gaps"].length;
         };
         return gaps;
      };

      function final_score_fill() {
         // Load values
         title = sessionStorage.getItem("last_questions_title");
         if (title === null) {
            title = "Puntuación no almacenada";
         }
         points = sessionStorage.getItem("last_questions_points");
         if (points === null) {
            points = 0;
         }

         // Hide HUD
         var hud_element = document.getElementById("hud_id");
         hud_element.style.display = "none";

         // Big header
         var header_element = document.getElementById("header_id");
         header_element.innerHTML = title;
         header_element.style.fontSize = "48px";
         header_element.style.paddingTop = "32px";

         // Show points
         var question_frame_element = document.getElementById("question_frame_id");
         if (watermark == 1) {
            question_frame_element.innerHTML = "";
            question_frame_element.insertAdjacentHTML("afterbegin", "<h1 style=\"font-size:80px\">"
            + Math.round(points) + "%"
            + "</h1> <h1>- - - - - - -</h1>");
            watermark = 2;
         }
         else {
            question_frame_element.innerHTML = "";
            question_frame_element.innerHTML = "";
            question_frame_element.insertAdjacentHTML("afterbegin", "<h1 style=\"font-size:80px\">"
            + Math.round(points) + "%"
            + "</h1> <h1>= = = = = =</h1>");
            watermark = 1;
         }
         buttons_final_score_fill();
      };

      function buttons_questions_fill() {
         var buttons_frame_element = document.getElementById("buttons_id");
         buttons_frame_element.innerHTML = ''
         + '<button class="func_button" onclick="check_answers()">Comprobar</button>'
         + '<button class="func_button" onclick="show_clue()">Pista</button>'
         + '<button class="func_button" onclick="next_page()">Siguiente</button>'
         + '<br><button class="func_button" onclick="last_score()">Puntuación anterior</button>';
      }

      function buttons_final_score_fill() {
         var buttons_frame_element = document.getElementById("buttons_id");
         buttons_frame_element.innerHTML = '<button class="func_button" onclick="page_reset()">Reiniciar</button>';
      }

      function message_show(message) {
         var message_text_element = document.getElementById("message_text_id");
         message_text_element.innerHTML = message;
         var message_element = document.getElementById("message_id");
         message_element.style.display = "inline";
         var button_element = document.getElementById("message_button_id");
         button_element.focus();
      }

      function message_hide() {
         var message_element = document.getElementById("message_id");
         var message_text_element = document.getElementById("message_text_id");
         message_text_element.innerHTML = "";
         message_element.style.display = "none";

         focus_empty_gap();
      }

      function focus_empty_gap() {
         var num_gaps = 0;
         var gaps_length = questions_sorted[page]["Gaps"].length;

         while (1) {
            var gap_element = document.getElementById("gap_{0}".format(gap_selected));
            if (gap_element) {
               gap_element.focus();
               break;
            }
            gap_selected += 1;
            if (gap_selected > gaps_length) {
               gap_selected = 0;
            }
            num_gaps += 1;
            if (num_gaps > 100) {
               break;
            }
         }
      }

      function next_page() {
         message_hide();

         // Check gaps
         var gaps_not_solved = count_blank_answers();

         // Check if all gaps are filled
         if (gaps_not_solved > 0) {
            if (gaps_not_solved == 1) {
               message_show("Aún falta 1 hueco por resolver.");
            }
            else {
               message_show("Aún faltan " + gaps_not_solved + " huecos por resolver.");
            };
            return;
         };

         // Go to next page or final page
         page++;
         if (page < questions_sorted.length) {
            hud_show();
            fill_question_text(page);
         }
         else {
            sessionStorage.setItem('last_questions_title', questions_title);
            sessionStorage.setItem('last_questions_points', points_total);
            final_score_interval = setInterval(final_score_fill, 500);
         }

         // Init variables
         gap_selected = 0;
      };

      function last_score() {
         if (timeout_last_score === 1) {
            final_score_interval = setInterval(final_score_fill, 500);
         }
         else {
            timeout_last_score = 1;
            setTimeout(reset_timeout_last_score, 400);
            return;
         }
      }

      function reset_timeout_last_score() {
         timeout_last_score = 0;
      }

      function questions_page_gaps(page) {
         return questions_sorted[page]["Gaps"].length;
      }

      function fill_question_text(page) {
         message_hide();
         points_page = 0;

         // Fill header
         var header_element = document.getElementById("header_id");
         header_element.innerHTML = questions_title;
         header_element.style.fontSize = "32px";
         header_element.style.paddingTop = "0px";

         // Fill question frame HTML
         var question_frame_element = document.getElementById("question_frame_id");
         question_frame_element.innerHTML = ''
         + '<div class="question_image_div" id="question_image_div_id"><img src=""></div>'
         + '<div class="question_text" id="question_text_id"></div>';

         // Read variables
         var question_text = questions_sorted[page]["Cloze"];
         var question_image = questions_sorted[page]["Image"][0];
         var question_image_size = questions_sorted[page]["Image"][1];

         // Image
         image_code = '<img class="question_image" src="{0}"{1}>';
         if (question_image_size) {
            var image_values = [question_image, ' width="{0}"'.format(question_image_size)];
         }
         else {
            var image_values = [question_image, ''];
         };
         image_code_formatted = image_code.format(...image_values);
         var question_image_element = document.getElementById("question_image_div_id");
         if (question_image) {
            question_image_element.innerHTML = image_code_formatted;
         }
         else {
            question_image_element.innerHTML = "";
         };

         // Question text
         var gaps_length = questions_sorted[page]["Gaps"].length;
         var gaps_not_solved = gaps_length;
         var gap_span = new Array(gaps_length);
         gap_span_code = '<span class="gap_span" id="gap_span_{0}">'
         + '<input type="text" autocomplete="off" class="gap_box" id="gap_{0}" '
         + 'size="12" onfocus="select_gap({0})" onkeypress="onkeypress_handle({0}, event)"></span>';
         for (var i=0; i<=gaps_length; i++) {
            gap_span[i] = gap_span_code.format(i);
         };
         var question_text_formatted = question_text.format(...gap_span);
         var question_text_element = document.getElementById("question_text_id");
         question_text_element.innerHTML = question_text_formatted;

         // Buttons
         buttons_questions_fill();
         clearInterval(interval);

         // Focus first gap
         var gap_element = document.getElementById("gap_0");
         if (gap_element) {
            gap_element.focus();
         }
      }

      function hud_show() {
         // Show HUD
         var hud_element = document.getElementById("hud_id");
         hud_element.style.display = "flex";

         // Page HUD
         var hud_page_element = document.getElementById("hud_page_id");
         hud_page_element.innerHTML = 'Página {0}/{1}'.format(page + 1, questions_sorted.length);

         var progress_bar_full_element = document.getElementById("progress_bar_full_id");
         var width = ((page + 1) / questions_sorted.length) * 100;
         progress_bar_full_element.style.width = `${width}%`;

         // Points
         var score_element = document.getElementById("score");
         score_element.innerHTML = Math.round(points_total);
      };

      function onkeypress_handle(gap, event) {
         if (event.keyCode == 13) {
            event.preventDefault();
            check_answers();
         };
      };

      function check_answers() {
         message_hide();

         gaps_not_solved = count_blank_answers();

         if (gaps_not_solved > 0) {
            if (gaps_not_solved == 1) {
               message_show("Aún falta 1 hueco por resolver.");
            }
            else {
               message_show("Aún faltan " + gaps_not_solved + " huecos por resolver.");
            };
         }
         else {
            message_show("Todos los huecos están resueltos."
            + "<br>Pulsa <strong>Siguiente</strong> para continuar.");
         }
      };

      function count_blank_answers() {
         // Leer gaps y comprobar que son correctos
         var gaps_length = questions_sorted[page]["Gaps"].length;
         var gaps_not_solved = gaps_length;
         for (var num_gap=0; num_gap<gaps_length; num_gap++) {
            var gap_element = document.getElementById("gap_{0}".format(num_gap));
            if (gap_element === null || gap_element === 'undefined' ) {
               gaps_not_solved -= 1;
               continue;
            };
            var gap_text = gap_element.value.toLowerCase().trim();
            gap_text.replace(/\s\s+/g, ' ');
            if (gap_text === "") {
               continue;
            };
            var answer = test_answer_correct(page, num_gap, gap_text);
            if (answer !== false) {
               var gap_span_element = document.getElementById("gap_span_{0}".format(num_gap));
               gap_span_element.innerHTML = answer;
               points_total += add_terms(gaps_values[page][num_gap]) / gaps_total;
               hud_show();
               gaps_not_solved -= 1;
            }
            else {
               if (gaps_tries[page][num_gap] === 1) {
                  var gap_span_element = document.getElementById("gap_span_{0}".format(num_gap));
                  gap_span_element.innerHTML = questions_sorted[page]["Gaps"][num_gap][0];
                  gaps_not_solved -= 1;
               }
               else if (gaps_tries[page][num_gap] > 1) {
                  gaps_tries[page][num_gap] -= 1;
               }
            }
         };
         return gaps_not_solved;
      }

      function test_answer_correct(page, num_gap, gap_text) {
         var num_answers = questions_sorted[page]["Gaps"][num_gap].length;
         for (var j=0; j<num_answers; j++) {
            var answer = questions_sorted[page]["Gaps"][num_gap][j];
            if (gap_text === answer.toLowerCase()) {
               return answer;
            };
         };
         return false;
      }

      function select_gap(num) {
         gap_selected = num;
      };

      function reset_timeout_clue() {
         timeout_clue = 0;
      }

      function show_clue() {
         message_hide();
         if (timeout_clue !== 0) {
            return;
         }
         timeout_clue = 1;
         setTimeout(reset_timeout_clue, time_between_clues);

         var gaps_visited = 0;
         var gaps_length = questions_sorted[page]["Gaps"].length;
         if (gap_selected < 0 || gap_selected >= gaps_length) {
            gap_selected = 0;
         };
         while (true) {
            while (true) {
               if (gaps_visited >= gaps_length) {
                  message_show("Todos los huecos están resueltos."
                  + "<br>Pulsa <strong>Siguiente</strong> para continuar.");
                  return;
               }
               if (gap_selected >= gaps_length) {
                  gap_selected = 0;
               }
               var correct_answer = questions_sorted[page]["Gaps"][gap_selected][0];
               var gap_element = document.getElementById("gap_{0}".format(gap_selected));
               if (gap_element === null) {
                  gap_selected += 1;
                  gaps_visited += 1;
                  continue;
               }
               else {
                  break;
               };
            }
            var gap_text = gap_element.value.toLowerCase();
            var i = 0;
            while (true) {
               if (i >= correct_answer.length) {
                  if (gap_text.length > correct_answer.length) {
                     // Correct gap answer with more letters
                     gap_element.value = gap_element.value.substr(0, correct_answer.length);
                     gap_selected++;
                     return;
                  }
                  // next gap
                  gap_selected++;
                  if (gap_selected >= gaps_length) {
                     return; // No gap to fill
                  };
                  // Go to next gap
                  break;
               };
               if (i >= gap_text.length) {
                  gap_text = correct_answer.substr(0, i+1);
                  gap_element.value = gap_text;
                  gaps_values[page][gap_selected][i] = 0;
                  return;
               };
               if (gap_text.charAt(i).toLowerCase() !== correct_answer.charAt(i).toLowerCase()) {
                  gap_text = correct_answer.substr(0, i+1);
                  gap_element.value = gap_text;
                  gaps_values[page][gap_selected][i] = 0;
                  return;
               };
               i++;
            };
         };
      };

   </script>

</body>

</html>